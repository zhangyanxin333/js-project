obj = [
    {id:1,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:2,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:3,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:4,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:5,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:6,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:7,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:8,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:9,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:10,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:11,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:12,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:13,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:14,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:15,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:16,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:17,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:18,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:19,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {id:20,
    img:"../images/goods1.jpg",
    title:"七分妆玻尿酸水润面膜",
    price:"￥99.00"},
    {
        id:21,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:22,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:23,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:24,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:25,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:26,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:27,
        title:"hehehehehe",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:28,
        title:"恭喜你哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:29,
        title:"祝贺你哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:30,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:31,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:32,
        title:"嘉特彩钢涨型保温瓶3101-130Y",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:33,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:34,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:35,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:36,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:37,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:38,
        title:"你是最帅的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:39,
        title:"你是最美的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:40,
        title:"你是最美的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    },
    {
        id:41,
        title:"你是最美的哦",
        price:"¥95.00",
        img:"../images/kuaizi.jpg"
    }
]
//设置cookie
function setCookie(key,val,expires){
	var d = new Date();
	d.setDate(d.getDate()+expires);

	document.cookie = key+"="+val+";path=/;expires="+d;
}

//删除cookie
function removeCookie(key,val){
	setCookie(key,val,-1)
}

//获取cookie
function getCookie(key){
	var cookie = document.cookie;
	var arr = cookie.split("; ");
	for(var i=0;i<arr.length;i++){
		var newArr = arr[i].split("=");
		if(key == newArr[0]){
			return newArr[1];
		}
	}
}
//将内容渲染到的区域
var oMain = document.getElementById("main");
var str = "";
//从cookie中取值  然后与与数组对象中的id值对比 如果相同的话 就将其渲染到页面中
if(getCookie("info")){
    //console.log(JSON.parse(getCookie("info")))
    var arr = JSON.parse(getCookie("info"))
    //console.log(arry)
    for(var i=0;i<arr.length;i++){
        for(var j=0;j<obj.length;j++){
            if(arr[i].id == obj[j].id){
                str += `
                <div class="item-body">
                <ul class="item-content clearfix goods_17470_10447" class="content">
                
                    <li class="td td-chk">
                        <input type="checkbox">
                    </li>
                    <li class="td td-item">
                        <div class="td-inner">
                            <div class="item-pic">
                                <a href="##" target="_blank" class="">
                                    <img src="${obj[j].img}" class="itempic">
                                </a>
                            </div>
                            <div class="item-info">
                                <div class="item-basic-info">
                                    <a href="" target="_blank" title="妮维雅水漾透白防晒凝露SPF30" class="item-title">
                                        ${obj[j].title}
                                    </a>
                                </div>
                            <div class="item-other-info">
                                <div class="promo-logos"></div>
                                <div class="item-icon-list">
                                    <div class="item-icons">
                                        <a href="##" class="item-icon" />
                                            <img src="../images/prod2.png" />
                                        </a>
                                        <a href="##" class="item-icon" />
                                            <img src="../images/prod3.png" />
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="td td-info">
                </li>
                <li class="td td-price">
                    <div class="td-inner">
                        <div class="item-price">
                            <div class="price-content">
                                
                                <div class="price-line price-line1">
                                    <em class="price-now">${obj[j].price}</em>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="td td-amount">
                    <div class="td-inner">
                        <div class="amount-wrapper">
                            <div class="item-amount">
                                <!--   -->
                                <span class="amount-widget amount">
                                    <input type="text" class="amount-input" value="${arr[i].num}" >
                                    <span class="amount-btn">
                                        <span class="amount-plus">
                                            <i class="plus">+</i>
                                        </span>
                                        <span class="amount-minus">
                                            <i class="minus">-</i>
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div class="amount-msg" style="display:none">
                            </div>
                        </div>
                    </div>
                </li>
                <li class="td td-sum">
                    <div class="td-inner">
                        <em class="number second-color">${"¥"+arr[i].num*obj[j].price.slice(1)}</em>
                    </div>
                </li>
                <li class="td td-op">
                    <div class="td-inner">
                        <a href="##" class="del" data-cart-id="17470">删除</a>
                    </div>
                </li>
            </ul>
            </div>
            `
            }
        }
    }
    oMain.innerHTML = str;
} 

var oContents = document.getElementById("main");
oContents.onclick = function(e){
    // console.log(i)
    var e = e || event;
    var target = e.target || e.srcElement;
    //商品增加减少按钮
    if(target.className == "plus"){
        // var 
        var value = target.parentNode.parentNode.previousElementSibling.value;
        value++;
        target.parentNode.parentNode.previousElementSibling.value = value;
        //获取总额的初始值然后乘以数量
        var price = target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.previousElementSibling.children[0].innerText.slice(1);
        // console.log(price)
        //获取总金额的初始价格用单价乘以数量来代替
        var sum = target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.nextElementSibling.children[0].children;
        // console.log(sum)
        sum[0].innerHTML = "¥" + (price * value);
    }
    else if(target.className == "minus"){
        var value = target.parentNode.parentNode.previousElementSibling.value;
        // console.log(value)
        //获取总额的初始值然后乘以数量
        var price = target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.previousElementSibling.children[0].innerText.slice(1);
        // console.log(price)
        //获取总金额的初始价格用单价乘以数量来代替
        var sum = target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.nextElementSibling.children[0].children;
        // console.log(value)
        if(value > 0){
            value--;
            target.parentNode.parentNode.previousElementSibling.value = value;
            sum[0].innerHTML = "¥" + (price * value);
            // str[0].innerHTML = "¥" + (price * value);
        }
        else{
            target.parentNode.parentNode.previousElementSibling.value = 0;
            sum[0].innerHTML = "¥" + (price * value);            
        }
    }
    //删除按钮
    else if(target.className == "del"){
        var grandparent = target.parentNode.parentNode.parentNode.parentNode;
        grandparent.remove();
        var oNum = document.getElementsByClassName("item-body");
        console.log(oNum)
        if(oNum.length == 0){
            //这里需要修改
            location.href="car.html"; 
        }
    }
}

